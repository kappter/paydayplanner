<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payday Planner</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        #header-text {
            text-align: center;
            font-size: 18px;
            margin-bottom: 20px;
            color: #555;
        }
        #date-control {
            text-align: center;
            margin-bottom: 10px;
        }
        #date-control button {
            padding: 8px 12px;
            margin: 0 5px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
        }
        #date-control button:hover {
            background-color: #0056b3;
        }
        #upload-section {
            text-align: center;
            margin-bottom: 20px;
        }
        #budget-select {
            margin: 10px 0;
            padding: 8px;
            width: 200px;
        }
        #file-input {
            margin: 10px 0;
        }
        #csv-instructions {
            font-size: 14px;
            color: #333;
            margin-bottom: 10px;
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 4px;
        }
        #result {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        #total-amount, #total-monthly {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
        }
        #included-bills {
            list-style-type: none;
            padding: 0;
        }
        #included-bills li {
            margin: 10px 0;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 4px;
        }
        .bill-title {
            font-weight: bold;
        }
        .bill-day {
            color: #555;
            margin-right: 5px;
        }
        .bill-amount {
            float: right;
            color: #28a745;
        }
    </style>
</head>
<body>
    <h1>Payday Planner</h1>
    <p id="header-text"></p>
    <div id="date-control">
        <button onclick="changeDate(-1)">Previous Day</button>
        <button onclick="changeDate(1)">Next Day</button>
    </div>
    <div id="upload-section">
        <label for="budget-select">Select a sample budget:</label><br>
        <select id="budget-select">
            <option value="low">Low-Income Family Sample</option>
            <option value="middle" selected>Middle-Class Family Sample</option>
            <option value="upper">Upper Middle-Class Family Sample</option>
        </select><br>
        <p id="csv-instructions">Your CSV file must have the columns: <strong>title</strong> (bill name), <strong>description</strong> (bill details), <strong>amount</strong> (numeric cost), and <strong>day</strong> (day of the month, 1â€“31).</p>
        <label for="file-input">Or upload your own CSV file:</label><br>
        <input type="file" id="file-input" accept=".csv">
    </div>
    <div id="result" style="display: none;">
        <p>Next payday: <span id="next-payday"></span></p>
        <p>Total amount required until next payday: $<span id="total-amount"></span></p>
        <p>Total monthly expenses: $<span id="total-monthly"></span></p>
        <h2>Included Bills:</h2>
        <ul id="included-bills"></ul>
    </div>

    <script>
        // Sample CSV contents
        const lowIncomeCsv = `title,description,amount,day
Rent,Monthly apartment rent,1375,2
Credit Card Payment,Minimum credit card payment,315,2
Storage,EXTRA SPACE 8002 801,125,3
Life Insurance,NORTHWESTERN MU PYMNT WEB WEB,163.72,4
UEN,UTAH EDUCATION ANEAEFTTRAN PPD,40.9,4
Home Insurance,FARMERS INS BILLING 877,31.27,4
Gym Membership,Gym membership fee,27,7
Audible,AUDIBLE*Z703E4VQ1 AMZN.COM,16.18,8
Music,SPOTIFY 877,21.64,14
Apple,Apple Storage,10.99,14
Car Insurance,Auto insurance premium,152.33,15
Internet Bill,GOOGLE FIBER DHF7Q2 650,30.6,15
Credit Card Payment,Minimum credit card payment,315,16
Phone Bill,Cell phone service,360,18
UEN,UTAH EDUCATION ANEAEFTTRAN PPD,40.9,18
Electricity Bill,Electric utility,55,20
Amazon,AMAZON PRIME,16.23,23
TV,PAYPAL HULU INST XFER WEB (S),41.11,25
Car Insurance,PROG CLASSIC INS PREM WEB (R),48.09,28
YouTube,YOUTUBEPREMIUM 650,29.94,29
`;

        const middleClassCsv = `title,description,amount,day
Mortgage,Monthly home mortgage payment,2000,1
Electricity Bill,Electric utility service,150,15
Water Bill,Water and sewer utility,60,20
Phone Bill,Family cell phone plan with data,120,10
Internet Bill,High-speed home internet,80,12
Car Insurance,Auto insurance for two vehicles,150,5
Home Insurance,Homeowners insurance policy,100,1
Health Insurance,Family health insurance premium,400,1
Student Loan,Monthly student loan repayment,250,3
Credit Card Payment,Minimum credit card payment,150,28
Cable TV,Cable television with premium channels,90,8
Gym Membership,Standard gym membership for family,50,7
Streaming Services,Multiple streaming platforms (Netflix, Hulu),30,18
Car Loan 1,Monthly car loan for primary vehicle,300,4
Car Loan 2,Monthly car loan for secondary vehicle,250,4
Life Insurance,Family life insurance policy,80,2
HOA Fees,Homeowners association dues,100,15
Property Taxes,Monthly escrow for property taxes,200,1
Pest Control,Home pest control service,40,19
Lawn Care,Basic lawn maintenance service,50,22
Trash Service,Municipal trash and recycling,40,15
Gas Utility,Natural gas for heating and cooking,100,22
Home Security System,Monthly monitoring fee,40,11
Dental Insurance,Family dental plan,50,1
Vision Insurance,Vision care insurance,30,1
Pet Insurance,Insurance for family pet,25,6
Childcare After-School Program,After-school care fee,200,5
Tutoring Service,Monthly tutoring for child,100,9
Music Lessons,Weekly music lessons for child,80,13
Cable Modem Rental,Internet equipment rental,15,12
HVAC Maintenance,Annual HVAC service contract (monthly),20,17
Pool Maintenance,Backyard pool cleaning service (if applicable),60,24
Storage Unit,Medium storage unit rental,50,6
Appliance Warranty,Extended warranty on appliances,15,26`;

        const upperMiddleClassCsv = `title,description,amount,day
Mortgage,Monthly mortgage for larger home,4000,1
Electricity Bill,Electric utility service,250,15
Water Bill,Water and sewer utility,80,20
Phone Bill,Premium family cell phone plan with unlimited data,200,10
Internet Bill,Fiber-optic high-speed internet,120,12
Car Insurance,Auto insurance for three vehicles including luxury,300,5
Home Insurance,Comprehensive homeowners insurance,200,1
Health Insurance,Premium family health insurance,600,1
Student Loan,Monthly student loan repayment,400,3
Credit Card Payment,Minimum payment on multiple cards,300,28
Cable TV,Premium cable with sports packages,150,8
Gym Membership,High-end gym or fitness club membership,100,7
Streaming Services,Bundle of streaming services (Netflix, Disney+, Amazon Prime),50,18
Car Loan 1,Monthly loan for luxury vehicle,500,4
Car Loan 2,Monthly loan for family SUV,400,4
Car Loan 3,Monthly loan for teen's car,300,4
Life Insurance,High-coverage family life insurance,150,2
HOA Fees,Upscale community HOA dues,200,15
Property Taxes,Monthly escrow for higher property taxes,500,1
Pest Control,Professional home pest control,60,19
Lawn Care,Full landscaping and lawn service,150,22
Trash Service,Private trash and recycling pickup,60,15
Gas Utility,Natural gas for home and appliances,150,22
Home Security System,Advanced security system with cameras,80,11
Dental Insurance,Comprehensive family dental plan,100,1
Vision Insurance,Family vision care insurance,50,1
Pet Insurance,Premium insurance for multiple pets,50,6
Private School Tuition,Monthly tuition for one child,1000,1
Tutoring Service,Private tutoring sessions,200,9
Music Lessons,Private music lessons for children,150,13
Sports Club Fees,Youth sports league membership,100,16
Cable Modem Rental,High-end internet equipment rental,20,12
HVAC Maintenance,Premium HVAC service contract,50,17
Pool Maintenance,Professional pool and spa maintenance,100,24
Storage Unit,Large climate-controlled storage,100,6
Appliance Warranty,Extended warranties on high-end appliances,30,26
House Cleaning Service,Bi-weekly cleaning service,200,25
Financial Advisor Fee,Monthly financial planning service,150,8
Investment Account Fee,Brokerage account maintenance,50,14
Country Club Membership,Monthly club dues,300,3
Travel Insurance,Annual travel policy (monthly equivalent),40,21
Boat Insurance,Insurance for recreational boat,100,7
Second Home HOA,Fees for vacation property,150,15
Art Lessons,Private art classes for family,100,27
Yoga Studio Membership,Specialty yoga or wellness membership,80,23`;

        let currentDate = new Date(); // Initialize with current date
        let currentCsv = middleClassCsv; // Default to middle class

        // Load default budget on page load
        window.onload = function() {
            calculateAndDisplay(parseCSV(currentCsv));
        };

        // Dropdown change event
        document.getElementById('budget-select').addEventListener('change', function() {
            const selected = this.value;
            if (selected === 'low') {
                currentCsv = lowIncomeCsv;
            } else if (selected === 'middle') {
                currentCsv = middleClassCsv;
            } else if (selected === 'upper') {
                currentCsv = upperMiddleClassCsv;
            }
            calculateAndDisplay(parseCSV(currentCsv));
        });

        // File upload event
        document.getElementById('file-input').addEventListener('change', handleFileUpload);

        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                currentCsv = e.target.result;
                calculateAndDisplay(parseCSV(currentCsv));
            };
            reader.readAsText(file);
        }

        // Date change function for forward/backward buttons
        function changeDate(days) {
            currentDate.setDate(currentDate.getDate() + days);
            calculateAndDisplay(parseCSV(currentCsv));
        }

        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
            if (!headers.includes('title') || !headers.includes('description') || !headers.includes('amount') || !headers.includes('day')) {
                alert('CSV must contain columns: title, description, amount, day');
                return [];
            }
            const bills = [];

            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split(',').map(v => v.trim());
                if (values.length < 4) continue;

                const bill = {
                    title: values[0],
                    description: values[1],
                    amount: parseFloat(values[2]),
                    day: parseInt(values[3])
                };

                if (!isNaN(bill.amount) && !isNaN(bill.day) && bill.day >= 1 && bill.day <= 31) {
                    bills.push(bill);
                }
            }

            return bills;
        }

        function calculateAndDisplay(bills) {
            const now = new Date(currentDate); // Use adjustable currentDate
            const currentDay = now.getDate();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();

            let nextPayDay, nextPayMonth = currentMonth, nextPayYear = currentYear;
            if (currentDay < 15) {
                nextPayDay = 15;
            } else {
                nextPayDay = 1;
                nextPayMonth++;
                if (nextPayMonth > 11) {
                    nextPayMonth = 0;
                    nextPayYear++;
                }
            }

            const nextPayDate = new Date(nextPayYear, nextPayMonth, nextPayDay);

            let total = 0;
            const includedBills = [];

            bills.forEach(bill => {
                let dueYear = currentYear;
                let dueMonth = currentMonth;
                if (bill.day <= currentDay) {
                    dueMonth++;
                    if (dueMonth > 11) {
                        dueMonth = 0;
                        dueYear++;
                    }
                }

                let dueDate = new Date(dueYear, dueMonth, bill.day);

                if (dueDate < nextPayDate && dueDate > now) {
                    total += bill.amount;
                    includedBills.push(bill);
                }
            });

            // Calculate total monthly expenses
            const totalMonthly = bills.reduce((sum, bill) => sum + bill.amount, 0);

            displayResults(now, nextPayDate, total, totalMonthly, includedBills);
        }

        function displayResults(currentDate, nextPayDate, total, totalMonthly, includedBills) {
            document.getElementById('header-text').textContent = 
                `Today is ${currentDate.toDateString()} and you will need to leave $${total.toFixed(2)} in your account before your next paycheck on ${nextPayDate.toDateString()}.`;

            document.getElementById('next-payday').textContent = nextPayDate.toDateString();
            document.getElementById('total-amount').textContent = total.toFixed(2);
            document.getElementById('total-monthly').textContent = totalMonthly.toFixed(2);

            const list = document.getElementById('included-bills');
            list.innerHTML = '';
            includedBills.forEach(bill => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span class="bill-title">${bill.title}</span>
                    <span class="bill-day">${bill.day}</span>
                    <span class="bill-description"> - ${bill.description}</span>
                    <span class="bill-amount">$${bill.amount.toFixed(2)}</span>
                `;
                list.appendChild(li);
            });

            document.getElementById('result').style.display = 'block';
        }
    </script>
</body>
</html>
